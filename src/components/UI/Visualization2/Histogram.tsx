/* eslint-disable @typescript-eslint/camelcase */
/* eslint-disable react-hooks/exhaustive-deps */
import React, { useEffect } from 'react';
import { Card } from 'react-bootstrap';
import HistogramModel from '../../../models/HistogramModel';

declare let window: any;

const Histogram = () => {
  const Bokeh = window.Bokeh;
  const plot = Bokeh.Plotting;

  // Raw data
  const title = 'Normal Distribution (μ=0, σ=0.5)';
  const hist = [
    0.03240964,
    0,
    0.01620482,
    0,
    0.03240964,
    0.08102411,
    0.11343375,
    0.08102411,
    0.1458434,
    0.06481929,
    0.21066268,
    0.17825304,
    0.24307233,
    0.40512055,
    0.45373501,
    0.53475912,
    0.46993983,
    0.64819287,
    0.58337359,
    0.95608449,
    0.64819287,
    0.81024109,
    0.76162663,
    0.79403627,
    0.74542181,
    0.92367485,
    0.97228931,
    0.69680734,
    0.56716876,
    0.45373501,
    0.48614466,
    0.40512055,
    0.59957841,
    0.40512055,
    0.3727109,
    0.27548197,
    0.30789162,
    0.19445786,
    0.17825304,
    0.09722893,
    0.09722893,
    0.03240964,
    0.03240964,
    0.01620482,
    0.01620482,
    0,
    0.03240964,
    0,
    0.01620482,
    0.01620482
  ];

  const edgesLeft = [
    -1.48313357,
    -1.42142354,
    -1.35971351,
    -1.29800349,
    -1.23629346,
    -1.17458343,
    -1.1128734,
    -1.05116338,
    -0.98945335,
    -0.92774332,
    -0.86603329,
    -0.80432327,
    -0.74261324,
    -0.68090321,
    -0.61919318,
    -0.55748316,
    -0.49577313,
    -0.4340631,
    -0.37235307,
    -0.31064305,
    -0.24893302,
    -0.18722299,
    -0.12551297,
    -0.06380294,
    -0.00209291,
    0.05961712,
    0.12132714,
    0.18303717,
    0.2447472,
    0.30645723,
    0.36816725,
    0.42987728,
    0.49158731,
    0.55329734,
    0.61500736,
    0.67671739,
    0.73842742,
    0.80013745,
    0.86184747,
    0.9235575,
    0.98526753,
    1.04697755,
    1.10868758,
    1.17039761,
    1.23210764,
    1.29381766,
    1.35552769,
    1.41723772,
    1.47894775,
    1.54065777
  ];

  const edgesRight = [
    -1.42142354,
    -1.35971351,
    -1.29800349,
    -1.23629346,
    -1.17458343,
    -1.1128734,
    -1.05116338,
    -0.98945335,
    -0.92774332,
    -0.86603329,
    -0.80432327,
    -0.74261324,
    -0.68090321,
    -0.61919318,
    -0.55748316,
    -0.49577313,
    -0.4340631,
    -0.37235307,
    -0.31064305,
    -0.24893302,
    -0.18722299,
    -0.12551297,
    -0.06380294,
    -0.00209291,
    0.05961712,
    0.12132714,
    0.18303717,
    0.2447472,
    0.30645723,
    0.36816725,
    0.42987728,
    0.49158731,
    0.55329734,
    0.61500736,
    0.67671739,
    0.73842742,
    0.80013745,
    0.86184747,
    0.9235575,
    0.98526753,
    1.04697755,
    1.10868758,
    1.17039761,
    1.23210764,
    1.29381766,
    1.35552769,
    1.41723772,
    1.47894775,
    1.54065777,
    1.6023678
  ];

  const responseData: HistogramModel = {
    title,
    hist,
    edgesLeft,
    edgesRight
  };

  const data = new Bokeh.ColumnDataSource({
    data: {
      title: responseData.title,
      hist: responseData.hist,
      edgesLeft: responseData.edgesLeft,
      edgesRight: responseData.edgesRight
    }
  });

  const p = plot.figure({
    title: data.title,
    tools: '',
    background_fill_color: '#fafafa'
  });

  p.quad({
    top: { field: 'hist' },
    bottom: 0,
    left: { field: 'edgesLeft' },
    right: { field: 'edgesRight' },
    fill_color: 'navy',
    line_color: 'white',
    alpha: 0.5,
    source: data
  });

  // add labels

  useEffect(() => {
    plot.show(p, '#chart-histogram');
  }, [plot]);

  return (
    <>
      <Card>
        <div id={`chart-histogram`}></div>
      </Card>
    </>
  );
};

export default Histogram;
